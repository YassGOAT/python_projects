{% extends 'base.html' %}

{% block content %}

<section class="game">
    <div class="top-bar">
        <div>Solde : <span>{{ balance }} €</span></div>
        <div>Mise : <span>{{ bet }} €</span></div>
    </div>

    <div class="table">
        <!-- Main du croupier -->
        <div class="hand dealer">
            <h3>Croupier : {{ dealer_name }}</h3>
            <div class="cards">
                {% if not finished %}
                    {% if dealer_hand.cards %}
                        <div class="card {% if dealer_hand.cards[0].suit in ['Cœur','Carreau'] %}red{% endif %}">
                            <span class="value">{{ dealer_hand.cards[0].value }}</span>
                            <span class="suit">
                                {% if dealer_hand.cards[0].suit == 'Pique' %}♠
                                {% elif dealer_hand.cards[0].suit == 'Trèfle' %}♣
                                {% elif dealer_hand.cards[0].suit == 'Carreau' %}♦
                                {% elif dealer_hand.cards[0].suit == 'Cœur' %}♥
                                {% endif %}
                            </span>
                        </div>
                        <div class="card back">
                            <span class="value">?</span>
                        </div>
                    {% else %}
                        <p>Aucune carte</p>
                    {% endif %}
                {% else %}
                    {% for card in dealer_hand.cards %}
                        <div class="card {% if card.suit in ['Cœur','Carreau'] %}red{% endif %}">
                            <span class="value">{{ card.value }}</span>
                            <span class="suit">
                                {% if card.suit == 'Pique' %}♠
                                {% elif card.suit == 'Trèfle' %}♣
                                {% elif card.suit == 'Carreau' %}♦
                                {% elif card.suit == 'Cœur' %}♥
                                {% endif %}
                            </span>
                        </div>
                    {% endfor %}
                {% endif %}
            </div>
            {% if finished %}
                <p class="score">Score : {{ dealer_score }}</p>
            {% endif %}
        </div>

        <!-- Main du joueur -->
        <div class="hand player">
            <h3>Joueur : {{ player_name }}</h3>
            <div class="cards">
                {% for card in player_hand.cards %}
                    <div class="card {% if card.suit in ['Cœur','Carreau'] %}red{% endif %}">
                        <span class="value">{{ card.value }}</span>
                        <span class="suit">
                            {% if card.suit == 'Pique' %}♠
                            {% elif card.suit == 'Trèfle' %}♣
                            {% elif card.suit == 'Carreau' %}♦
                            {% elif card.suit == 'Cœur' %}♥
                            {% endif %}
                        </span>
                    </div>
                {% endfor %}
            </div>
            <p class="score">Score : {{ player_score }}</p>
        </div>
    </div>

    {% if message %}
        <p class="message">{{ message }}</p>
    {% endif %}

    {% if not finished %}
        <div class="actions">
            <a class="btn primary" href="{{ url_for('hit') }}">Tirer</a>
            <a class="btn secondary" href="{{ url_for('stand') }}">Rester</a>
        </div>
    {% else %}
        <div class="actions">
            <a class="btn primary" href="{{ url_for('index') }}">Nouvelle manche</a>
        </div>
    {% endif %}
</section>

{% endblock %}
